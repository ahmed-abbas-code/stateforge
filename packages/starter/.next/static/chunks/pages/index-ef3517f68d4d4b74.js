(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[332],{1152:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>y});var n=r(4513),a=r(4285),o=r(1723);class s{async get(e){if("undefined"==typeof window)return void console.warn(`[LocalStorage] Attempted to access key "${e}" in a non-browser environment.`);try{let t=localStorage.getItem(e);if(null===t)return;return JSON.parse(t)}catch(t){console.error(`[LocalStorage] Failed to parse value for key "${e}":`,t);return}}async set(e,t){if("undefined"==typeof window)return void console.warn(`[LocalStorage] Attempted to set key "${e}" in a non-browser environment.`);try{let r=JSON.stringify(t);localStorage.setItem(e,r)}catch(t){console.error(`[LocalStorage] Failed to serialize value for key "${e}":`,t)}}}var i=r(5189);let l=r(5592).env.NEXT_PUBLIC_BACKEND_APP_REST_API_BASE_URL;l||console.warn("[StateForge] Missing NEXT_PUBLIC_BACKEND_APP_REST_API_BASE_URL in environment");let c=i.A.create({baseURL:l,withCredentials:!0,timeout:1e4,headers:{"Content-Type":"application/json"}});c.interceptors.request.use(e=>{let t="undefined"!=typeof window?localStorage.getItem("auth_token"):null;return t&&(e.headers.Authorization=`Bearer ${t}`),e});class d{async get(e){var t;try{return null==(t=(await c.get(`/state/${e}`)).data)?void 0:t.value}catch(t){console.error(`[RestApi] Failed to get key "${e}":`,t);return}}async set(e,t){try{await c.post(`/state/${e}`,{value:t})}catch(t){console.error(`[RestApi] Failed to set key "${e}":`,t)}}}function u(e){switch(e){case"localStorage":return new s;case"restApi":return new d;default:throw Error(`[StateForge] Unsupported strategy "${e}"`)}}function p({key:e,defaultValue:t,strategy:r}){let[n,o]=(0,a.useState)(t);return(0,a.useEffect)(()=>{(async()=>{try{let t=u(r),n=await t.get(e);null!=n&&o(n)}catch(t){console.error(`[StateForge] Failed to load key "${e}":`,t)}})()},[e,r]),[n,t=>{o(t);try{u(r).set(e,t)}catch(t){console.error(`[StateForge] Failed to persist key "${e}":`,t)}}]}function y(){let e=(0,a.useContext)(o.cr);if(!e)throw Error("AppStateContext must be used within AppStateProvider");let{appSharedState:t,setAppSharedState:r}=e,[s,i]=p({key:"client_input",strategy:"localStorage",defaultValue:""}),[l,c]=p({key:"server_input",strategy:"restApi",defaultValue:""}),[d,u]=(0,a.useState)(!1);return(0,a.useEffect)(()=>{r(e=>({...e,hydrated:!0,lastUpdated:new Date().toISOString()})),u(!0)},[r]),(0,n.jsxs)("main",{style:{padding:"2rem",fontFamily:"sans-serif"},children:[(0,n.jsx)("h1",{children:"StateForge Sample App"}),(0,n.jsxs)("section",{style:{marginTop:"2rem"},children:[(0,n.jsx)("h2",{children:"Client-side State (Persisted)"}),(0,n.jsx)("input",{type:"text",value:s,onChange:e=>i(e.target.value),placeholder:"Enter client-only data",style:{width:"100%",padding:"0.5rem"}})]}),(0,n.jsxs)("section",{style:{marginTop:"2rem"},children:[(0,n.jsx)("h2",{children:"Server-side State (Persisted via API)"}),(0,n.jsx)("input",{type:"text",value:l,onChange:e=>c(e.target.value),placeholder:"Enter server-synced data",style:{width:"100%",padding:"0.5rem"}})]}),(0,n.jsxs)("section",{style:{marginTop:"2rem"},children:[(0,n.jsx)("h2",{children:"Shared Application State"}),(0,n.jsx)("pre",{style:{backgroundColor:"#f4f4f4",padding:"1rem"},children:JSON.stringify(t,null,2)})]}),(0,n.jsx)("section",{style:{marginTop:"2rem"},children:(0,n.jsxs)("p",{children:["Status: ",(0,n.jsx)("strong",{children:d?"Loaded":"Loading..."})]})})]})}},9740:(e,t,r)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return r(1152)}])}},e=>{var t=t=>e(e.s=t);e.O(0,[189,636,593,792],()=>t(9740)),_N_E=e.O()}]);